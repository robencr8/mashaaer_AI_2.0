"""
Apology Generator Engine - Provides guidance for crafting sincere and effective apologies.
"""

def handle_apology_query(prompt: str) -> str:
    """
    Handles queries related to crafting apologies and making amends.
    
    Args:
        prompt (str): The user's prompt/query related to apologies
        
    Returns:
        str: Response with guidance or a generated apology
    """
    # Simple keyword-based response system
    # In a real implementation, this would connect to a more sophisticated apology generation system
    
    if "أخت" in prompt or "أخي" in prompt or "أخوي" in prompt:
        return "رسالة اعتذار لأخت/أخ:\n\n\"أختي العزيزة/أخي العزيز،\n\nأكتب إليك لأعبر عن اعتذاري الصادق عما بدر مني. أدرك أن تصرفي/كلامي كان خاطئاً وجرح مشاعرك، وهذا آخر ما كنت أرغب فيه. علاقتنا الأخوية ثمينة جداً بالنسبة لي، ولا أريد أن يؤثر سوء تفاهم أو خطأ على الرابطة القوية التي تجمعنا.\n\nأتفهم تماماً مشاعرك، وأقدر صبرك. أعدك بأن أكون أكثر حرصاً وتفهماً في المستقبل، وأن أبذل قصارى جهدي لتجنب تكرار ما حدث.\n\nأتمنى أن تتسع قلبك لقبول اعتذاري، وأن نتجاوز هذا الموقف معاً. أنت تعني الكثير بالنسبة لي، وسأكون ممتناً/ممتنة للفرصة لإصلاح ما حدث.\n\nبكل محبة واحترام،\n[اسمك]\""

    elif "صديق" in prompt or "صديقة" in prompt or "صداقة" in prompt:
        return "رسالة اعتذار لصديق/صديقة:\n\n\"صديقي العزيز/صديقتي العزيزة،\n\nأرسل لك هذه الرسالة لأعبر عن اعتذاري العميق عما حدث بيننا. أدرك تماماً أن تصرفي كان خاطئاً، وأشعر بالندم الشديد لأنني تسببت في إيذاء مشاعرك. صداقتنا ثمينة جداً بالنسبة لي، وأشعر بالأسف لأنني لم أكن الصديق/الصديقة الذي تستحقه/تستحقينه في تلك اللحظة.\n\nأقدر الصدق والثقة التي بنيناها معاً على مر السنين، وأعدك أنني سأبذل كل ما في وسعي لاستعادة هذه الثقة وتعزيزها. أتمنى أن تمنحني فرصة لإظهار مدى تقديري لصداقتنا من خلال أفعالي وليس فقط كلماتي.\n\nأتفهم إذا كنت تحتاج لبعض الوقت، وسأحترم مساحتك الشخصية. لكنني أريدك أن تعلم أنني هنا عندما تكون مستعداً/مستعدة للحديث.\n\nبصداقة خالصة،\n[اسمك]\""

    elif "والد" in prompt or "أم" in prompt or "أب" in prompt or "أهل" in prompt:
        return "رسالة اعتذار للوالدين:\n\n\"أمي العزيزة/أبي العزيز،\n\nأكتب إليك برغبة صادقة في الاعتذار عن سلوكي وكلماتي التي أدرك الآن كم كانت مؤلمة. أشعر بالندم العميق لأنني لم أظهر الاحترام والتقدير الذي تستحقه/تستحقينه دائماً.\n\nأعلم أن كل ما فعلته وتفعله/تفعلينه هو من أجل مصلحتي، وأن حبك ودعمك كانا دائماً ثابتين في حياتي. أقدر تضحياتك وصبرك وحكمتك التي لم أكن دائماً متقبلاً/متقبلة لها.\n\nأتعهد بأن أكون أكثر تفهماً واحتراماً، وأن أسعى جاهداً/جاهدة لأكون الابن/الابنة الذي يجعلك فخوراً/فخورة. أرجو أن تسامحني وتمنحني الفرصة لإظهار نضجي وامتناني.\n\nأحبك كثيراً وأقدر وجودك في حياتي أكثر مما يمكنني التعبير عنه.\n\nابنك المحب/ابنتك المحبة،\n[اسمك]\""

    elif "زوج" in prompt or "زوجة" in prompt or "شريك" in prompt:
        return "رسالة اعتذار للزوج/الزوجة/الشريك:\n\n\"حبيبي/حبيبتي،\n\nأكتب إليك بقلب مليء بالندم والحب لأعتذر عما بدر مني. أدرك أن كلماتي/تصرفاتي قد جرحتك، وهذا يؤلمني بعمق لأنك أغلى شخص في حياتي.\n\nأقدر صبرك ودعمك المستمر، وأشعر بالأسف لأنني لم أكن على مستوى هذا الحب في تلك اللحظة. أعدك أنني سأعمل على تحسين طريقة تعاملي مع خلافاتنا، وأن أكون أكثر تفهماً لمشاعرك واحتياجاتك.\n\nعلاقتنا هي أثمن ما أملك، وأنا ملتزم/ملتزمة بالعمل يومياً على تقويتها وحمايتها. أتمنى أن تمنحني فرصة لإظهار حبي واحترامي من خلال أفعالي.\n\nأحبك بكل قلبي وأتوق لتجاوز هذه اللحظة الصعبة معاً، لنعود أقوى وأكثر تفاهماً.\n\nبكل الحب،\n[اسمك]\""

    elif "مدير" in prompt or "رئيس" in prompt or "عمل" in prompt or "وظيفة" in prompt:
        return "رسالة اعتذار مهنية لمدير/زميل عمل:\n\n\"السيد/السيدة [الاسم]،\n\nأتقدم إليكم باعتذاري الصادق عن [وصف الخطأ بإيجاز]. أدرك تماماً أن هذا الخطأ قد أثر على سير العمل وأتحمل كامل المسؤولية عنه.\n\nأؤكد لكم أنني قد اتخذت الخطوات التالية لضمان عدم تكرار هذا الموقف مستقبلاً: [اذكر الإجراءات التصحيحية التي اتخذتها أو ستتخذها].\n\nأقدر ثقتكم وأتفهم أهمية الالتزام بالمعايير المهنية العالية التي تتوقعونها. أتطلع إلى استعادة ثقتكم من خلال أدائي المستقبلي والتزامي بتحقيق أهداف الفريق والمؤسسة.\n\nأشكركم على سعة صدركم وتفهمكم.\n\nمع فائق الاحترام والتقدير،\n[اسمك]\n[منصبك/قسمك]\""

    elif "معلم" in prompt or "أستاذ" in prompt or "مدرسة" in prompt:
        return "رسالة اعتذار لمعلم/أستاذ:\n\n\"السيد/السيدة [اسم المعلم/الأستاذ] المحترم/المحترمة،\n\nأتقدم إليكم باعتذاري الصادق عن [وصف ما حدث]. أدرك أن سلوكي/تقصيري كان غير لائق وأنه أخل بسير الحصة الدراسية/المحاضرة.\n\nأقدر جهودكم المستمرة في تعليمنا وتوجيهنا، وأشعر بالأسف لأنني لم أظهر الاحترام الذي تستحقونه. ألتزم بتحسين سلوكي/أدائي والتركيز على دراستي بجدية أكبر.\n\nأتمنى أن تتقبلوا اعتذاري وتمنحوني فرصة لإثبات التزامي وجديتي. أعدكم بأن أبذل قصارى جهدي لأكون على مستوى توقعاتكم في المستقبل.\n\nمع فائق الاحترام والتقدير،\n[اسمك]\n[الصف/المستوى الدراسي]\""

    elif "خطأ" in prompt or "غلطة" in prompt:
        return "إرشادات لصياغة اعتذار فعال عن خطأ:\n\n1. كن واضحاً ومباشراً: اعترف بالخطأ دون مواربة أو تبرير.\n\n2. عبّر عن الندم الحقيقي: أظهر فهمك لتأثير خطئك على الشخص الآخر.\n\n3. تحمل المسؤولية كاملة: تجنب إلقاء اللوم على الظروف أو الآخرين.\n\n4. قدم تعويضاً إن أمكن: اعرض طريقة لإصلاح الضرر أو التعويض عنه.\n\n5. التزم بالتغيير: وضح الخطوات التي ستتخذها لتجنب تكرار نفس الخطأ.\n\n6. اطلب المسامحة: اطلب العفو بتواضع دون توقع أو إلحاح.\n\n7. امنح الوقت: تفهم أن المسامحة قد تستغرق وقتاً، واحترم مشاعر الطرف الآخر.\n\nتذكر أن الاعتذار الصادق هو بداية عملية إصلاح العلاقة، وليس نهايتها."

    elif "تأخير" in prompt or "موعد" in prompt:
        return "رسالة اعتذار عن التأخير أو تفويت موعد:\n\n\"عزيزي/عزيزتي [الاسم]،\n\nأتقدم باعتذاري الشديد عن [التأخر عن موعدنا/عدم حضوري للموعد] اليوم. أدرك تماماً أن وقتك ثمين، وأن هذا التأخير/الغياب قد سبب لك إزعاجاً وربما عطل جدولك.\n\nسبب تأخري/غيابي هو [اذكر السبب بإيجاز دون الدخول في تفاصيل مبالغ فيها أو أعذار]. مع ذلك، أتحمل كامل المسؤولية عن عدم التزامي بالوقت المتفق عليه.\n\nأقدر صبرك وتفهمك، وأود أن أقترح [إعادة جدولة الموعد/تعويض الوقت الضائع] في وقت يناسبك. سأكون أكثر حرصاً على الالتزام بالمواعيد في المستقبل واحترام وقتك الثمين.\n\nمرة أخرى، أعتذر عن هذا الإزعاج وأشكرك على سعة صدرك.\n\nمع خالص التقدير،\n[اسمك]\""

    elif "سوء فهم" in prompt or "سوء تفاهم" in prompt:
        return "رسالة اعتذار عن سوء فهم أو سوء تفاهم:\n\n\"عزيزي/عزيزتي [الاسم]،\n\nأكتب إليك لأعتذر عن سوء الفهم الذي حدث بيننا بخصوص [موضوع سوء الفهم]. بعد التفكير في الموقف، أدركت أن هناك اختلافاً في فهمنا للموضوع، وأن كلماتي/تصرفاتي قد تكون أُسيء تفسيرها.\n\nلم تكن نيتي أبداً أن أسبب أي إساءة أو انزعاج، وأشعر بالأسف لأن ذلك حدث. أقدر علاقتنا كثيراً وأحرص على التواصل الواضح والصادق معك.\n\nأتمنى أن نتمكن من مناقشة الموضوع بشكل أكثر وضوحاً لتجنب أي سوء فهم مستقبلي. أنا منفتح/منفتحة للاستماع لوجهة نظرك والتعلم منها.\n\nأشكرك على تفهمك وصبرك، وآمل أن نتجاوز هذا الموقف معاً.\n\nبكل احترام وتقدير،\n[اسمك]\""

    elif "كلام جارح" in prompt or "إساءة" in prompt or "جرح" in prompt:
        return "رسالة اعتذار عن كلام جارح أو إساءة:\n\n\"عزيزي/عزيزتي [الاسم]،\n\nأكتب إليك بقلب مثقل بالندم لأعتذر بشدة عن الكلمات الجارحة التي صدرت مني. أدرك الآن مدى الألم الذي سببته لك، وأشعر بأسف عميق لذلك.\n\nلا يوجد أي مبرر للطريقة التي تحدثت بها، وأتحمل كامل المسؤولية عن كلماتي وتأثيرها عليك. كان يجب أن أتعامل مع الموقف بمزيد من الضبط النفسي والاحترام.\n\nأقدر وجودك في حياتي، وأعدك أن أعمل على تحسين طريقة تعبيري عن مشاعري، خاصة في لحظات التوتر. سأبذل جهداً واعياً للتفكير قبل الكلام وللتعبير عن نفسي بطريقة أكثر لطفاً واحتراماً.\n\nأتمنى أن تتمكن من مسامحتي مع الوقت، وأتفهم إذا كنت تحتاج لمساحة شخصية الآن.\n\nباعتذار صادق وعميق،\n[اسمك]\""

    else:
        return "الاعتذار الصادق هو مهارة مهمة في العلاقات الإنسانية وخطوة أساسية نحو إصلاح العلاقات المتضررة. يمكنني مساعدتك في صياغة رسالة اعتذار مناسبة لمختلف المواقف والعلاقات، مثل: الاعتذار لأفراد العائلة (أخ/أخت، والدين)، الأصدقاء، الشريك/الزوج/الزوجة، زملاء العمل أو المدير، المعلمين، أو الاعتذار عن أخطاء محددة مثل التأخير، سوء الفهم، أو الكلام الجارح. ما نوع الاعتذار الذي تحتاج إلى صياغته؟"